# Recommender Systems
Some of the machine learning projects I worked on for my former company in helping users recommend products, movies and candidates.

I started with very simple item-item collaborative filtering method to recommend relevant products from the superstore datasets that is provided by Tableau. You may find the data here: https://community.tableau.com/docs/DOC-1236

The collaborative filtering(CF) uses actions of users to suggest the similar items that have similar features. To implement CF, KNN is one of the simplest and effective methods to select from. KNN is known for memory based approach, works directly with the values and searches of its nearest neighbors instantaneously, assuming no pre-built model. The Product Recommendations.py file in my repository takes records of interaction between a user and a product and calculates the similarities based on the quantity/clicks a user has performed and retrieves 5 closest neighbors to be the possible recommendations to the user.

However, one might notice that with the increase in data, feature space also increases, which will require more and more resources from your machine as well as lead to overfitting in your model. In order to reduce the collected features, PCA is one of the many unsupervised techniques that can help reduce the feature space. PCA constructs numbers of principal component, each of which contributes different variation in the data. By choosing the number of components, it will retain certain amount of information in the subspace that is being projected to higher dimension. Here, the PCA function defined in the Python file, I passed .95 as a parameter to the PCA model to select optimal number of principle components that can explain 95% of variation, which will simplify the dataset used to run the KNN algorithm.

This is just a extremely simplified product recommendation example. There are still so much more topics needed to cover. For example, how do I deal with sparse matrix? how do I predict the rating of other products? and how do I evaluate the model?

The "movie recommendation - item-based collaborative filtering" file dives in more machine learning concepts that hasn't covered previously. In this file, I imported the movie dataset from the website. You may download it from the link here: https://grouplens.org/datasets/movielens/latest/. The dataset is quite similar to the superstore dataset I used previously instead of the column names for product ID and product name has been changed movie ID and movie name respectively. The data contains 100836 ratings that were created by 610 users from 1995 to 2018. In this post, I filtered out some items since I'm only interested in recommending 2000s movies. After building the use-item ratings matrix, I realized the matrix is very sparse(that is, contains mostly empty values), even we have collected data from highly engaged users and items, the sparcity is still 95% since a single viewer cannot give ratings to all the items. The sparcity is a common issue when implementing collabortive filtering which soley relies on similarity measures computed over the co-rated set of items. To combat the sparcity issue, I used baseline predictions methods that fill empty values for a user by averaging the ratings of other movies that this user has rated. This is just one of many approaches to solve the sparsity. There are other algorithms that could be a better solution, for example, the matrix factorization, which I will cover in the later post. 

The matrix is now zero sparsity and is able to compute PCA technique and KNN algorithms from the previous Python file that will eventually output the suggested items based on the similarities of this item to the others. One must notice that the traditional distance measure in KNN doesn't work well in this case because of the sparsity. For example, the two movie vectors may have many zeros in common, meaning both movies donn't share similar characteristics but this doesn't make them the similar. Futhermore, this KNN does not return the predicted rating of a user but the indice and distances recommended movies, meaning there are more work to be done to generate the possible rating which could be helpful to evaluate the accuracy of the model. To obtain the predicted ratings is simple. By using a weighted average to calculate the item      



